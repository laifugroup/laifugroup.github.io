<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>忘记密码 - 山海卡牌交易平台</title><link rel="icon" type="image/png" href="/icon.png"><link href="/css/955.f983cd0d.css" rel="stylesheet"></head><body><div class="login-container"><div class="login-card"><div class="form-container"><div class="form-header"><h2>找回密码</h2><p>请输入您的邮箱地址，我们将发送重置密码的链接</p></div><form id="forgot-password-form" class="auth-form"><div class="form-group"><label for="email">邮箱地址</label> <input type="email" id="email" name="email" required placeholder="请输入您的邮箱地址"> <span class="error-message" id="email-error"></span></div><button type="submit" class="btn-primary" id="send-email-btn"><span class="btn-text">发送重置邮件</span> <span class="btn-loading hidden"><i class="icon-loading"></i> 发送中...</span></button><div class="form-footer"><p>记起密码了？ <a href="login.html">返回登录</a></p><p>还没有账户？ <a href="login.html?mode=register">立即注册</a></p></div></form><div id="success-message" class="success-container hidden"><div class="success-icon">✅</div><h3>邮件发送成功！</h3><p>我们已向 <strong id="sent-email"></strong> 发送了密码重置邮件。</p><p>请检查您的邮箱（包括垃圾邮件文件夹），并点击邮件中的链接重置密码。</p><div class="success-actions"><button onclick="resendEmail()" class="btn-secondary" id="resend-btn">重新发送邮件</button> <a href="login.html" class="btn-primary">返回登录</a></div></div></div><div class="bg-decoration"><div class="card-float card-1"></div><div class="card-float card-2"></div><div class="card-float card-3"></div></div></div></div><script>let isSubmitting=!1,lastEmailSent="";async function handleForgotPassword(e){if(e.preventDefault(),isSubmitting)return;const t=e.target,s=new FormData(t).get("email").trim();if(validateEmailFormat(s))try{isSubmitting=!0,setButtonLoading("send-email-btn",!0),console.log("🔄 正在发送重置密码邮件...",{email:s});const e=await sendResetPasswordEmail(s);console.log("✅ 邮件发送成功:",e),showSuccessMessage(s),lastEmailSent=s}catch(e){console.error("❌ 发送邮件失败:",e);let t="发送邮件失败，请稍后重试";404===e.status?t="该邮箱地址未注册":429===e.status?t="发送过于频繁，请稍后再试":e.message&&(t=e.message),showMessage(t,"error")}finally{isSubmitting=!1,setButtonLoading("send-email-btn",!1)}}async function sendResetPasswordEmail(e){const t=await fetch("/v1/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({email:e})}),s=await t.json();if(!t.ok){const e=new Error(s.message||"发送邮件失败");throw e.status=t.status,e}return s}function validateEmailFormat(e){if(!e)return showFieldError("email-error","请输入邮箱地址"),!1;return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?(clearFieldError("email-error"),!0):(showFieldError("email-error","请输入有效的邮箱地址"),!1)}function validateEmail(){validateEmailFormat(document.getElementById("email").value.trim())}function clearEmailError(){clearFieldError("email-error")}function showSuccessMessage(e){const t=document.getElementById("forgot-password-form"),s=document.getElementById("success-message"),n=document.getElementById("sent-email");t&&s&&n&&(t.style.display="none",n.textContent=e,s.classList.remove("hidden"))}async function resendEmail(){if(lastEmailSent)try{setButtonLoading("resend-btn",!0),await sendResetPasswordEmail(lastEmailSent),showMessage("邮件已重新发送","success")}catch(e){console.error("❌ 重新发送邮件失败:",e),showMessage("重新发送失败，请稍后重试","error")}finally{setButtonLoading("resend-btn",!1)}}function setButtonLoading(e,t){const s=document.getElementById(e);if(!s)return;const n=s.querySelector(".btn-text"),o=s.querySelector(".btn-loading");t?(s.disabled=!0,n&&n.classList.add("hidden"),o&&o.classList.remove("hidden")):(s.disabled=!1,n&&n.classList.remove("hidden"),o&&o.classList.add("hidden"))}function showFieldError(e,t){const s=document.getElementById(e);s&&(s.textContent=t,s.style.display="block")}function clearFieldError(e){const t=document.getElementById(e);t&&(t.textContent="",t.style.display="none")}document.addEventListener("DOMContentLoaded",function(){console.log("🔄 忘记密码页面初始化...");const e=document.getElementById("forgot-password-form");e&&e.addEventListener("submit",handleForgotPassword);const t=document.getElementById("email");t&&(t.addEventListener("blur",validateEmail),t.addEventListener("input",clearEmailError)),console.log("✅ 忘记密码页面初始化完成")})</script><style>.success-container{text-align:center;padding:40px 20px}.success-icon{font-size:48px;margin-bottom:20px}.success-container h3{color:var(--text-primary);font-size:24px;margin-bottom:16px}.success-container p{color:var(--text-secondary);line-height:1.6;margin-bottom:12px}.success-actions{margin-top:30px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap}.btn-secondary{background:var(--btn-secondary-bg);color:#fff;padding:12px 24px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;text-decoration:none;display:inline-block}.btn-secondary:hover{background:var(--btn-secondary-hover);transform:translateY(-1px)}.form-footer{text-align:center;margin-top:25px;font-size:14px;color:var(--text-secondary)}.form-footer p{margin-bottom:8px}.form-footer a{color:var(--accent-primary);text-decoration:none;font-weight:500;transition:color .3s ease}.form-footer a:hover{color:var(--btn-primary-hover);text-decoration:underline}</style><script defer="defer" src="/js/runtime.eaa2a988.js"></script><script defer="defer" src="/js/vendor.3230c899.js"></script><script defer="defer" src="/js/955.5ee0a946.js"></script><script defer="defer" src="/js/622.43d28a7c.js"></script><script defer="defer" src="/js/forgot-password.e00b80fe.js"></script></body></html>