"use strict";(self.webpackChunkshanhaijing_card_game=self.webpackChunkshanhaijing_card_game||[]).push([[661],{16485:(n,t,e)=>{e.r(t)},81935:(n,t,e)=>{function r(){var n,t,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function s(e,r,i,o){var s=r&&r.prototype instanceof d?r:d,l=Object.create(s.prototype);return a(l,"_invoke",function(e,r,a){var i,o,s,d=0,l=a||[],u=!1,v={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(t,e){return i=t,o=0,s=n,v.n=e,c}};function p(e,r){for(o=e,s=r,t=0;!u&&d&&!a&&t<l.length;t++){var a,i=l[t],p=v.p,f=i[2];e>3?(a=f===r)&&(s=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=n):i[0]<=p&&((a=e<2&&p<i[1])?(o=0,v.v=r,v.n=i[1]):p<f&&(a=e<3||i[0]>r||r>f)&&(i[4]=e,i[5]=r,v.n=f,o=0))}if(a||e>1)return c;throw u=!0,r}return function(a,l,f){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&p(l,f),o=l,s=f;(t=o<2?n:s)||!u;){i||(o?o<3?(o>1&&(v.n=-1),p(o,s)):v.n=s:v.v=s);try{if(d=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(s=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=n}else if((t=(u=v.n<0)?s:e.call(r,v))!==c)break}catch(t){i=n,o=1,s=t}finally{d=1}}return{value:t,done:u}}}(e,i,o),!0),l}var c={};function d(){}function l(){}function u(){}t=Object.getPrototypeOf;var v=[][i]?t(t([][i]())):(a(t={},i,function(){return this}),t),p=u.prototype=d.prototype=Object.create(v);function f(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,a(n,o,"GeneratorFunction")),n.prototype=Object.create(p),n}return l.prototype=u,a(p,"constructor",u),a(u,"constructor",l),l.displayName="GeneratorFunction",a(u,o,"GeneratorFunction"),a(p),a(p,o,"Generator"),a(p,i,function(){return this}),a(p,"toString",function(){return"[object Generator]"}),(r=function(){return{w:s,m:f}})()}function a(n,t,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}a=function(n,t,e,r){function o(t,e){a(n,t,function(n){return this.t(t,e,n)})}t?i?i(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(o("next",0),o("throw",1),o("return",2))},a(n,t,e,r)}function i(n,t,e,r,a,i,o){try{var s=n[i](o),c=s.value}catch(n){return void e(n)}s.done?t(c):Promise.resolve(c).then(r,a)}function o(n){return function(){var t=this,e=arguments;return new Promise(function(r,a){var o=n.apply(t,e);function s(n){i(o,r,a,s,c,"next",n)}function c(n){i(o,r,a,s,c,"throw",n)}s(void 0)})}}e(40875),e(10287),e(3362),e(52675),e(89463),e(28706),e(74423),e(23792),e(62062),e(34782),e(62010),e(26099),e(27495),e(38781),e(21699),e(47764),e(25440),e(5746),e(42762),e(23500),e(62953),e(48408),e(90407),e(87006),e(90062),e(380),e(49078),e(14822),e(36099),e(16738),e(16485);var s={N:"bg-gray-500",R:"bg-blue-500",SR:"bg-purple-500",SSR:"bg-yellow-500",UR:"bg-red-500",LR:"bg-gradient-to-r from-purple-500 to-pink-500"},c={1:"N",2:"R",3:"SR",4:"SSR",5:"UR",6:"LR"},d={N:"普通卡",R:"稀有卡",SR:"超极稀有卡",SSR:"超超极稀有卡",UR:"终极稀有卡",LR:"传说级稀有卡"};function l(n){return c[n]||"N"}function u(){return(u=o(r().m(function n(t){var e,a;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,document.getElementById("card-detail-container")){n.n=1;break}return n.a(2);case 1:if(e=null,n.p=2,!window.CardAPI||!window.CardAPI.getCardDetail){n.n=4;break}return n.n=3,window.CardAPI.getCardDetail(t);case 3:(a=n.v)&&200===a.code&&a.data&&(e={id:a.data.id,name:a.data.cardName,cardNumber:a.data.cardNumber,cardType:a.data.cardType,rarity:l(a.data.rarity),element:a.data.element,series:a.data.series,hp:a.data.hp,attackPower:a.data.attackPower,defensePower:a.data.defensePower,skillName:a.data.skillName,skillEffect:a.data.skillEffect,lore:a.data.lore,price:a.data.marketPrice,image:a.data.imageUrl,isHolo:a.data.isHolo,status:a.data.status,userId:a.data.userId,createdAt:a.data.createdAt,updatedAt:a.data.updatedAt,category:a.data.element||"神兽",description:a.data.lore||"暂无描述"}),n.n=5;break;case 4:case 5:n.n=7;break;case 6:n.p=6,n.v;case 7:if(!e&&window.HomeModule&&window.HomeModule.getCardById&&(e=window.HomeModule.getCardById(t)),e){n.n=8;break}return N("无法加载卡牌详情，请返回首页重试"),n.a(2);case 8:v(e),j(e.category,e.id),document.title="".concat(e.name," - 卡牌详情 - 新山海经"),n.n=10;break;case 9:n.p=9,n.v,N("加载卡牌详情时发生错误，请刷新页面重试");case 10:return n.a(2)}},n,null,[[2,6],[0,9]])}))).apply(this,arguments)}function v(n){var t=document.getElementById("card-detail-container");if(t){var e;h=n.image?[n.image]:[],n.imageVariants&&Array.isArray(n.imageVariants)&&(h=h.concat(n.imageVariants)),w=0,t.innerHTML='\n        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 p-6 card-detail-grid">\n            \x3c!-- 卡牌图片 - 竖向展示 --\x3e\n            <div class="card-image-section">\n                \x3c!-- Three.js 3D卡牌展示容器 --\x3e\n        <div id="card-3d-container" class="card-3d-container h-[650px] mb-4 rounded-xl overflow-hidden relative">\n                    \x3c!-- Three.js将在这里渲染 --\x3e\n                </div>\n                \n                \x3c!-- 卡牌导航控制 --\x3e\n                <div class="flex justify-between items-center mt-4">\n                    <button id="prev-card-btn" class="card-nav-btn bg-white border border-gray-300 rounded-full p-2 shadow-sm hover:bg-gray-50 transition-colors">\n                        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>\n                        </svg>\n                    </button>\n                    \n                    <div class="card-pagination">\n                        <span id="current-card-index">1</span> / <span id="total-cards">'.concat(h.length,'</span>\n                    </div>\n                    \n                    <button id="next-card-btn" class="card-nav-btn bg-white border border-gray-300 rounded-full p-2 shadow-sm hover:bg-gray-50 transition-colors">\n                        <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>\n                        </svg>\n                    </button>\n                </div>\n                \n                \x3c!-- 稀有度标签 --\x3e\n                <div class="rarity-badge ').concat(s[n.rarity],' mt-4 inline-block">\n                    ').concat(n.rarity," - ").concat((e=n.rarity,d[e]||"普通卡"),'\n                </div>\n                \n                \x3c!-- 卡牌故事 - 移到这里 --\x3e\n                <div class="mt-6 bg-gray-800 bg-opacity-80 rounded-xl p-4 border border-gray-600">\n                    <h3 class="text-lg font-bold text-white mb-3 flex items-center">\n                        <svg class="w-5 h-5 mr-2 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">\n                            <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>\n                        </svg>\n                        故事\n                    </h3>\n                    <div class="card-story-content text-sm text-gray-300 leading-relaxed max-h-48 overflow-y-auto">\n                        ').concat(function(n){var t={神兽:'\n            <p class="mb-4"><strong>'.concat(n.name,"</strong>，传说中的神兽，据《山海经》记载，它生活在东方的神山之巅，掌管着天地间的").concat(Math.random()>.5?"雷电":"风雨",'。</p>\n            <p class="mb-4">相传在远古时期，').concat(n.name,"曾助黄帝平定天下，是上古时代的神圣守护者。它拥有着不可思议的力量，能够").concat(Math.random()>.5?"呼风唤雨":"移山填海",'，是人间秩序的维护者。</p>\n            <p class="mb-4">每当').concat(n.name,"现身，必有祥瑞降临。古籍中记载，见到").concat(n.name,"的人会得到上天的祝福，一生平安喜乐。</p>\n            <p>如今，").concat(n.name,"的形象被制作成了珍贵的收藏卡牌，承载着古老的传说与祝福。</p>\n        "),妖怪:'\n            <p class="mb-4"><strong>'.concat(n.name,'</strong>，古老传说中的奇异妖怪，栖息于深山老林之中，常在夜晚出没。</p>\n            <p class="mb-4">相传').concat(n.name,'拥有变化之术，能够幻化成人形迷惑世人。它既有邪恶的一面，也有善良的一面，对待善良的人会给予帮助，对待恶人则会施以惩罚。</p>\n            <p class="mb-4">在民间故事中，').concat(n.name,"曾多次与道士斗法，展现出非凡的法力。有些地方还流传着").concat(n.name,"与凡人结为伴侣的爱情故事。</p>\n            <p>这张卡牌记录了").concat(n.name,"的真实形态，据说在月圆之夜，卡牌会微微发光，仿佛").concat(n.name,"的灵魂依然存在于其中。</p>\n        "),仙人:'\n            <p class="mb-4"><strong>'.concat(n.name,'</strong>，道教传说中的仙人，修道千年，已得长生不老之术。</p>\n            <p class="mb-4">相传').concat(n.name,'曾是凡人，通过不懈的修行和对道的领悟，最终得道成仙。它精通丹道，能炼制各种灵丹妙药，救死扶伤。</p>\n            <p class="mb-4">').concat(n.name,"居住在仙境之中，偶尔会下凡济世救人。民间流传着许多").concat(n.name,"点化凡人、惩恶扬善的故事。</p>\n            <p>这张卡牌据说含有").concat(n.name,"的一丝仙气，能够为持有者带来好运和智慧。</p>\n        "),法宝:'\n            <p class="mb-4"><strong>'.concat(n.name,'</strong>，传说中的神秘法宝，拥有不可思议的力量。</p>\n            <p class="mb-4">相传此宝由上古神匠所铸，历经千年，吸收天地精华，已成灵物。它能').concat(Math.random()>.5?"呼风唤雨":"移山填海",'，是修道者梦寐以求的神器。</p>\n            <p class="mb-4">在古代传说中，').concat(n.name,"曾多次出现在关键历史时刻，改变战局，拯救苍生。它的持有者往往是当世英雄或隐世高人。</p>\n            <p>这张卡牌记录了").concat(n.name,"的真实形态和力量，是收藏家们争相追逐的珍品。</p>\n        "),地理:'\n            <p class="mb-4"><strong>'.concat(n.name,"</strong>，《山海经》中记载的神秘地域，位于").concat(Math.random()>.5?"东方神州":"西方大荒",'。</p>\n            <p class="mb-4">相传此地灵气充沛，奇花异草遍地，是众多神兽和仙人的栖息之所。在古代，能够到达').concat(n.name,'的人寥寥无几，都是有大机缘的修行者。</p>\n            <p class="mb-4">').concat(n.name,"的地貌奇特，有").concat(Math.random()>.5?"高耸入云的山峰":"深不见底的峡谷","，还有传说中能治百病的灵泉。</p>\n            <p>这张卡牌记录了").concat(n.name,"的壮丽景色，让人仿佛置身其中，感受那神秘而古老的氛围。</p>\n        "),default:'\n            <p class="mb-4"><strong>'.concat(n.name,'</strong>，《山海经》中记载的神秘存在，拥有着不为人知的力量和历史。</p>\n            <p class="mb-4">相传在远古时期，').concat(n.name,'曾与众多神话人物有过交集，留下了许多传奇故事。它的出现往往预示着重大事件的发生。</p>\n            <p class="mb-4">在民间流传的故事中，').concat(n.name,"既可能是祥瑞的象征，也可能带来灾难。人们对它既敬畏又向往。</p>\n            <p>这张卡牌记录了").concat(n.name,"的真实形态，是了解中国古代神话文化的重要窗口。</p>\n        ")};return t[n.category]||t.default}(n),'\n                    </div>\n                </div>\n            </div>\n            \n            \x3c!-- 卡牌信息 --\x3e\n            <div class="card-info">\n                <div class="flex justify-between items-start">\n                    <h1 class="card-name">').concat(n.name,'</h1>\n                    <span class="card-category">').concat(n.element||n.category,'</span>\n                </div>\n                \n                \x3c!-- 卡牌编号 --\x3e\n                <div class="text-sm text-gray-500 mb-2">').concat(n.cardNumber,'</div>\n                \n                \x3c!-- 卡牌描述/传说 --\x3e\n                <p class="card-description">').concat(n.lore||n.description,'</p>\n                \n                \x3c!-- 卡牌属性信息 --\x3e\n                <div class="grid grid-cols-3 gap-4 my-4 p-4 bg-gray-50 rounded-lg">\n                    <div class="text-center">\n                        <div class="text-sm text-gray-500">生命值</div>\n                        <div class="text-lg font-bold text-red-600">').concat(n.hp||0,'</div>\n                    </div>\n                    <div class="text-center">\n                        <div class="text-sm text-gray-500">攻击力</div>\n                        <div class="text-lg font-bold text-orange-600">').concat(n.attackPower||0,'</div>\n                    </div>\n                    <div class="text-center">\n                        <div class="text-sm text-gray-500">防御力</div>\n                        <div class="text-lg font-bold text-blue-600">').concat(n.defensePower||0,"</div>\n                    </div>\n                </div>\n                \n                \x3c!-- 技能信息 --\x3e\n                ").concat(n.skillName?'\n                <div class="mb-4 p-4 bg-indigo-50 rounded-lg">\n                    <div class="font-semibold text-indigo-800 mb-2">技能：'.concat(n.skillName,'</div>\n                    <div class="text-sm text-indigo-600">').concat(n.skillEffect,"</div>\n                </div>\n                "):"",'\n                \n                <div class="card-price">¥').concat((n.price||0).toLocaleString(),'</div>\n                \n                \x3c!-- 数量选择 --\x3e\n                <div class="quantity-selector">\n                    <button class="quantity-btn" onclick="updateQuantity(-1)">\n                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>\n                        </svg>\n                    </button>\n                    <input type="number" class="quantity-input" id="quantity" value="1" min="1" max="99">\n                    <button class="quantity-btn" onclick="updateQuantity(1)">\n                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>\n                        </svg>\n                    </button>\n                </div>\n                \n                \x3c!-- 按钮组 --\x3e\n                <div class="button-group">\n                    <button class="flex-1 bg-indigo-600 text-white py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors font-medium"\n                            onclick="buyCard(').concat(n.id,", '").concat(n.name,"', ").concat(n.price,')">\n                        立即购买\n                    </button>\n                    <button class="flex-1 bg-yellow-500 text-white py-3 px-6 rounded-lg hover:bg-yellow-600 transition-colors font-medium">\n                        立即购买\n                    </button>\n                </div>\n                \n                \x3c!-- 卡牌属性 --\x3e\n                <div class="card-attributes">\n                  \n                    <div class="attribute-item">\n                        <span class="attribute-label">编号</span>\n                        <span class="attribute-value">').concat(n.cardNumber,'</span>\n                    </div>\n                    <div class="attribute-item">\n                        <span class="attribute-label">稀有度</span>\n                        <span class="attribute-value">').concat(n.rarity,'</span>\n                    </div>\n                    \n                    <div class="attribute-item">\n                        <span class="attribute-label">系列</span>\n                        <span class="attribute-value">').concat(n.series,'</span>\n                    </div>\n                    <div class="attribute-item">\n                        <span class="attribute-label">闪卡</span>\n                        <span class="attribute-value">').concat(n.isHolo?"是":"否","</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n    ");var r=document.getElementById("quantity");r&&r.addEventListener("change",function(){var n=parseInt(r.value);isNaN(n)||n<1?r.value=1:n>99&&(r.value=99)}),document.querySelectorAll(".thumbnail-item").forEach(function(n){n.addEventListener("click",function(){var t=parseInt(n.dataset.index);document.querySelectorAll(".thumbnail-item").forEach(function(n){return n.classList.remove("active")}),n.classList.add("active"),R(h[t])})}),y(n.image,n)}}document.addEventListener("DOMContentLoaded",function(){var n=new URLSearchParams(window.location.search).get("id");n?setTimeout(function(){window.CardAPI?function(n){u.apply(this,arguments)}(n):N("API加载失败，请刷新页面重试")},200):N("未找到卡牌ID，请返回首页重新选择")});var p,f,b,m,g,x,h=[],w=0;function y(n,t){var e,r,a=document.getElementById("card-3d-container");if(a){var i=document.createElement("div");if(i.id="initial-loading",i.className="absolute inset-0 flex items-center justify-center z-20",i.innerHTML='\n        <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>\n    ',a.appendChild(i),a.classList.add("debug-border"),0!==a.clientWidth&&0!==a.clientHeight){p=new THREE.Scene,a.addEventListener("click",function(n){var t=a.getBoundingClientRect();!function(n,t,e){var r=["explosion-particle-blue","explosion-particle-pink","explosion-particle-yellow","explosion-particle-green","explosion-particle-red"],a=Math.floor(5*Math.random())+1;e.className=e.className.replace(/card-color-theme-\d+/g,""),e.classList.add("card-color-theme-".concat(a));for(var i=function(){var a=document.createElement("div");a.className="explosion-particle";var i=15*Math.random()+5;a.style.width="".concat(i,"px"),a.style.height="".concat(i,"px");var o=r[Math.floor(Math.random()*r.length)];a.classList.add(o),a.style.left="".concat(n,"px"),a.style.top="".concat(t,"px");var s=Math.random()*Math.PI*2,c=100*Math.random()+50,d=Math.cos(s)*c,l=Math.sin(s)*c;a.style.setProperty("--tx","".concat(d,"px")),a.style.setProperty("--ty","".concat(l,"px")),e.appendChild(a),setTimeout(function(){a.parentNode===e&&e.removeChild(a)},1e3)},o=0;o<30;o++)i()}(n.clientX-t.left,n.clientY-t.top,a)}),(f=new THREE.PerspectiveCamera(60,a.clientWidth/a.clientHeight,.1,1e3)).position.z=4,(b=new THREE.WebGLRenderer({antialias:!0,alpha:!0,preserveDrawingBuffer:!0})).setSize(a.clientWidth,a.clientHeight),b.setClearColor(0,0),b.setPixelRatio(window.devicePixelRatio),a.appendChild(b.domElement);var o=new THREE.AmbientLight(16777215,.7);p.add(o);var s=new THREE.DirectionalLight(16777215,.8);s.position.set(5,5,5),p.add(s);var c=new THREE.PointLight(6514417,1,10);c.position.set(2,2,2),p.add(c);var d=new THREE.SpotLight(16777215,.8);d.position.set(-5,5,5),d.angle=Math.PI/6,d.penumbra=.2,p.add(d);var l=new THREE.PointLight(65535,.5,15);l.position.set(-3,-3,2),p.add(l);var u=new THREE.PointLight(16711935,.5,15);u.position.set(3,3,2),p.add(u);var v=new THREE.PlaneGeometry(2.5,3.5);g=new THREE.MeshStandardMaterial({color:16777215,side:THREE.DoubleSide,metalness:.5,roughness:.5,transparent:!0,opacity:0,visible:!1}),m=new THREE.Mesh(v,g),p.add(m),x=new THREE.TextureLoader,n?E(n):k(t);var h=0,w=null,R=0,H=0,j=0,S=0;a.addEventListener("mousemove",function(n){var t=a.getBoundingClientRect();R=(n.clientX-t.left)/a.clientWidth*2-1,H=-(n.clientY-t.top)/a.clientHeight*2+1,N(n.clientX-t.left,n.clientY-t.top,a)}),a.addEventListener("mouseleave",function(){S=0,j=0}),a.addEventListener("touchmove",function(n){if(n.touches.length>0){var t=a.getBoundingClientRect(),e=n.touches[0];R=(e.clientX-t.left)/a.clientWidth*2-1,H=-(e.clientY-t.top)/a.clientHeight*2+1,N(e.clientX-t.left,e.clientY-t.top,a)}n.preventDefault()},{passive:!1}),a.addEventListener("touchend",function(){S=0,j=0}),window.addEventListener("resize",function(){f&&b&&a&&(f.aspect=a.clientWidth/a.clientHeight,f.updateProjectionMatrix(),b.setSize(a.clientWidth,a.clientHeight),b.setPixelRatio(window.devicePixelRatio))}),function n(){if(w=requestAnimationFrame(n),p&&m&&b){h+=.01,S=.3*R,j=.2*H,m.rotation.y+=.1*(S-m.rotation.y),m.rotation.x+=.1*(j-m.rotation.x),m.position.y=.05*Math.sin(h),c&&(c.position.x=3*Math.sin(.7*h),c.position.z=3*Math.cos(.5*h)),l&&u&&(l.position.x=3*Math.sin(.5*h),l.position.y=3*Math.cos(.7*h),u.position.x=3*Math.cos(.3*h),u.position.y=3*Math.sin(.6*h));try{b.render(p,f)}catch(t){cancelAnimationFrame(w)}}}(),e=document.getElementById("prev-card-btn"),r=document.getElementById("next-card-btn"),e&&e.addEventListener("click",T),r&&r.addEventListener("click",M)}else setTimeout(function(){return y(n)},500)}function N(n,t,e){if(!(Math.random()>.3)){var r=document.createElement("div");r.className="particle";var a=30*Math.random()+10;r.style.width="".concat(a,"px"),r.style.height="".concat(a,"px");var i=60*Math.random()+180;r.style.background="radial-gradient(circle, hsla(".concat(i,", 100%, 70%, 0.8) 0%, hsla(").concat(i,", 100%, 70%, 0) 70%)"),r.style.left="".concat(n,"px"),r.style.top="".concat(t,"px"),e.appendChild(r),setTimeout(function(){r.parentNode===e&&e.removeChild(r)},3e3)}}}function E(n){if(x&&g)if(n&&!n.includes("undefined")){var t=document.getElementById("card-3d-container");if(t){var e=document.createElement("div");e.id="texture-loading",e.className="absolute inset-0 flex items-center justify-center z-10",e.innerHTML='\n            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>\n        ';var r=document.getElementById("texture-loading");r&&r.remove(),t.appendChild(e)}g.emissive.set(0),g.emissiveIntensity=0,g.metalness=.5,g.roughness=.5,g.transparent=!1,g.opacity=1,x.load(n,function(n){n.encoding=THREE.sRGBEncoding||THREE.LinearEncoding,n.flipY=!0,n.minFilter=THREE.LinearFilter,n.magFilter=THREE.LinearFilter,n.generateMipmaps=!0;var t=function(n){var t=document.createElement("canvas"),e=t.getContext("2d",{willReadFrequently:!0});t.width=n.image.width,t.height=n.image.height;var r=.08*Math.min(t.width,t.height);e.clearRect(0,0,t.width,t.height),e.beginPath(),e.moveTo(r,0),e.lineTo(t.width-r,0),e.arcTo(t.width,0,t.width,r,r),e.lineTo(t.width,t.height-r),e.arcTo(t.width,t.height,t.width-r,t.height,r),e.lineTo(r,t.height),e.arcTo(0,t.height,0,t.height-r,r),e.lineTo(0,r),e.arcTo(0,0,r,0,r),e.closePath(),e.clip(),e.drawImage(n.image,0,0,t.width,t.height);var a=new THREE.Texture(t);return a.needsUpdate=!0,a.encoding=n.encoding,a.minFilter=n.minFilter,a.magFilter=n.magFilter,a.generateMipmaps=n.generateMipmaps,a}(n);g.map=t,g.transparent=!0,g.opacity=1,g.visible=!0,g.needsUpdate=!0;var e=document.getElementById("texture-loading");e&&e.remove();var r=document.getElementById("initial-loading");r&&r.remove()},function(n){},function(n){k()})}else k()}function k(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(g){var t=document.getElementById("texture-loading");t&&t.remove();var e=document.getElementById("initial-loading");e&&e.remove();var r="N",a="卡牌";if(n)r=n.rarity||"N",a=n.name||"卡牌";else{var i=document.querySelector(".rarity-badge");i&&(r=i.textContent.trim());var o=document.querySelector(".card-name");o&&(a=o.textContent.trim())}!function(n,t){var e={N:{primary:"#6b7280",secondary:"#4b5563"},R:{primary:"#3b82f6",secondary:"#1e40af"},SR:{primary:"#8b5cf6",secondary:"#6d28d9"},SSR:{primary:"#f59e0b",secondary:"#d97706"},UR:{primary:"#ef4444",secondary:"#dc2626"},LR:{primary:"#ec4899",secondary:"#db2777"}},r=e[t]||e.N,a=document.createElement("canvas"),i=a.getContext("2d");a.width=600,a.height=840;var o=48;i.beginPath(),i.moveTo(o,0),i.lineTo(a.width-o,0),i.arcTo(a.width,0,a.width,o,o),i.lineTo(a.width,a.height-o),i.arcTo(a.width,a.height,a.width-o,a.height,o),i.lineTo(o,a.height),i.arcTo(0,a.height,0,a.height-o,o),i.lineTo(0,o),i.arcTo(0,0,o,0,o),i.closePath(),i.clip();var s=i.createLinearGradient(0,0,a.width,a.height);s.addColorStop(0,r.primary),s.addColorStop(1,r.secondary),i.fillStyle=s,i.fillRect(0,0,a.width,a.height),i.fillStyle="white",i.font="bold 48px Arial, sans-serif",i.textAlign="center",i.textBaseline="middle",i.shadowColor="rgba(0, 0, 0, 0.5)",i.shadowBlur=4,i.shadowOffsetX=2,i.shadowOffsetY=2;for(var c=a.width-80,d=n.split(""),l="",u=[],v=0;v<d.length;v++){var p=l+d[v];i.measureText(p).width>c&&v>0?(u.push(l),l=d[v]):l=p}u.push(l);var f=a.height/2-60*(u.length-1)/2;u.forEach(function(n,t){i.fillText(n,a.width/2,f+60*t)}),i.font="bold 32px Arial, sans-serif",i.fillStyle="rgba(255, 255, 255, 0.9)",i.fillText(t,a.width/2,a.height-60);var b=new THREE.Texture(a);b.needsUpdate=!0,b.encoding=THREE.sRGBEncoding||THREE.LinearEncoding,b.flipY=!0,b.minFilter=THREE.LinearFilter,b.magFilter=THREE.LinearFilter,b.generateMipmaps=!0,g.map=b,g.color.set(16777215),g.emissive.set(0),g.emissiveIntensity=0,g.metalness=.5,g.roughness=.5,g.transparent=!0,g.opacity=1,g.visible=!0,g.needsUpdate=!0}(a,r)}}function R(n){g&&m&&(!n||n.includes("undefined")||n.includes("via.placeholder.com")?k():E(n))}function T(){h.length<=1||(w=(w-1+h.length)%h.length,H())}function M(){h.length<=1||(w=(w+1)%h.length,H())}function H(){R(h[w]);var n=document.getElementById("current-card-index");n&&(n.textContent=(w+1).toString())}function j(n,t){return S.apply(this,arguments)}function S(){return(S=o(r().m(function n(t,e){var a,i,o,c;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,a=document.getElementById("related-cards")){n.n=1;break}return n.a(2);case 1:return a.innerHTML='\n            <div class="col-span-full flex justify-center items-center py-8">\n                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"></div>\n                <span class="ml-3 text-gray-600">加载推荐中...</span>\n            </div>\n        ',i=[],n.p=2,n.n=3,window.CardAPI.getRelatedCards(t,e);case 3:(o=n.v)&&o.success&&o.data&&(i=o.data),n.n=5;break;case 4:n.p=4,n.v,window.HomeModule&&window.HomeModule.getCardsByCategory&&(i=window.HomeModule.getCardsByCategory(t,e))&&i.length;case 5:if(i&&0!==i.length){n.n=6;break}return a.innerHTML='\n                <div class="col-span-full text-center py-8">\n                    <p class="text-gray-500">暂无相关推荐卡牌</p>\n                </div>\n            ',n.a(2);case 6:i=i.slice(0,4),a.innerHTML="",i.forEach(function(n){var t=document.createElement("div");t.className="related-card bg-white shadow-md",t.innerHTML='\n                <a href="/card-detail.html?id='.concat(n.id,'" class="block">\n                    <div class="relative h-48 bg-gradient-to-br from-gray-100 to-gray-200 overflow-hidden">\n                        <img src="').concat(n.image,'" alt="').concat(n.name,"\" \n                             class=\"w-full h-full object-cover rounded-xl\"\n                             loading=\"lazy\"\n                             onerror=\"this.style.display='none'; this.parentElement.style.background='linear-gradient(135deg, #667eea 0%, #764ba2 100%)'; this.parentElement.innerHTML='<div style=\\'display:flex;align-items:center;justify-content:center;height:100%;color:white;font-weight:bold;text-align:center;padding:20px;\\'>").concat(n.name,'</div>\'">\n                        \n                        \x3c!-- 稀有度标签 --\x3e\n                        <div class="absolute top-2 right-2 ').concat(s[n.rarity],' text-white px-2 py-1 rounded-full text-xs font-bold">\n                            ').concat(n.rarity,'\n                        </div>\n                    </div>\n                    \n                    <div class="p-4">\n                        <h3 class="text-lg font-bold text-gray-900 truncate">').concat(n.name,'</h3>\n                        <p class="text-sm text-gray-500 mb-2">').concat(n.category,'</p>\n                        <div class="text-lg font-bold text-indigo-600">¥').concat(n.price.toLocaleString(),"</div>\n                    </div>\n                </a>\n            "),a.appendChild(t)}),n.n=8;break;case 7:n.p=7,n.v,(c=document.getElementById("related-cards"))&&(c.innerHTML='\n                <div class="col-span-full text-center py-8">\n                    <p class="text-gray-500">加载相关推荐失败</p>\n                </div>\n            ');case 8:return n.a(2)}},n,null,[[2,4],[0,7]])}))).apply(this,arguments)}function N(n){var t=document.getElementById("card-detail-container");t&&(t.innerHTML='\n            <div class="p-8 text-center">\n                <div class="text-red-500 mb-4">\n                    <svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n                    </svg>\n                </div>\n                <p class="text-gray-700 mb-4">'.concat(n,'</p>\n                <a href="/index.html" class="inline-block bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors">\n                    返回首页\n                </a>\n            </div>\n        '))}function q(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",e=document.createElement("div");e.className="fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium transform transition-all duration-300 translate-x-full ".concat("success"===t?"bg-green-500":"error"===t?"bg-red-500":"bg-blue-500"),e.textContent=n,document.body.appendChild(e),setTimeout(function(){e.classList.remove("translate-x-full")},100),setTimeout(function(){e.classList.add("translate-x-full"),setTimeout(function(){document.body.removeChild(e)},300)},3e3)}window.updateQuantity=function(n){var t=document.getElementById("quantity");if(t){var e=parseInt(t.value)+n;e<1&&(e=1),e>99&&(e=99),t.value=e}},window.buyCard=function(n,t,e){var r=parseInt(document.getElementById("quantity").value)||1,a=e*r;confirm("确认购买 ".concat(r," 张 ").concat(t,"？\n总价：¥").concat(a.toLocaleString()))&&q("正在购买 ".concat(r," 张 ").concat(t,"..."),"info"),window.addToCart?window.addToCart(n,t,e,r):q("已将 ".concat(r," 个 ").concat(t," 添加到购物车"),"success")}}},n=>{n.O(0,[502,955],()=>n(n.s=81935)),n.O()}]);