"use strict";(self.webpackChunkshanhaijing_card_game=self.webpackChunkshanhaijing_card_game||[]).push([[331],{24703:(n,t,r)=>{function e(){var n,t,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.toStringTag||"@@toStringTag";function c(r,e,a,i){var c=e&&e.prototype instanceof d?e:d,l=Object.create(c.prototype);return o(l,"_invoke",function(r,e,o){var a,i,c,d=0,l=o||[],s=!1,f={p:0,n:0,v:n,a:v,f:v.bind(n,4),d:function(t,r){return a=t,i=0,c=n,f.n=r,u}};function v(r,e){for(i=r,c=e,t=0;!s&&d&&!o&&t<l.length;t++){var o,a=l[t],v=f.p,g=a[2];r>3?(o=g===e)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=n):a[0]<=v&&((o=r<2&&v<a[1])?(i=0,f.v=e,f.n=a[1]):v<g&&(o=r<3||a[0]>e||e>g)&&(a[4]=r,a[5]=e,f.n=g,i=0))}if(o||r>1)return u;throw s=!0,e}return function(o,l,g){if(d>1)throw TypeError("Generator is already running");for(s&&1===l&&v(l,g),i=l,c=g;(t=i<2?n:c)||!s;){a||(i?i<3?(i>1&&(f.n=-1),v(i,c)):f.n=c:f.v=c);try{if(d=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=n}else if((t=(s=f.n<0)?c:r.call(e,f))!==u)break}catch(t){a=n,i=1,c=t}finally{d=1}}return{value:t,done:s}}}(r,a,i),!0),l}var u={};function d(){}function l(){}function s(){}t=Object.getPrototypeOf;var f=[][a]?t(t([][a]())):(o(t={},a,function(){return this}),t),v=s.prototype=d.prototype=Object.create(f);function g(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,s):(n.__proto__=s,o(n,i,"GeneratorFunction")),n.prototype=Object.create(v),n}return l.prototype=s,o(v,"constructor",s),o(s,"constructor",l),l.displayName="GeneratorFunction",o(s,i,"GeneratorFunction"),o(v),o(v,i,"Generator"),o(v,a,function(){return this}),o(v,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:g}})()}function o(n,t,r,e){var a=Object.defineProperty;try{a({},"",{})}catch(n){a=0}o=function(n,t,r,e){function i(t,r){o(n,t,function(n){return this.t(t,r,n)})}t?a?a(n,t,{value:r,enumerable:!e,configurable:!e,writable:!e}):n[t]=r:(i("next",0),i("throw",1),i("return",2))},o(n,t,r,e)}function a(n){return function(n){if(Array.isArray(n))return i(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return i(n,t);var r={}.toString.call(n).slice(8,-1);return"Object"===r&&n.constructor&&(r=n.constructor.name),"Map"===r||"Set"===r?Array.from(n):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(n,t){(null==t||t>n.length)&&(t=n.length);for(var r=0,e=Array(t);r<t;r++)e[r]=n[r];return e}function c(n,t,r,e,o,a,i){try{var c=n[a](i),u=c.value}catch(n){return void r(n)}c.done?t(u):Promise.resolve(u).then(e,o)}r(2259),r(23418),r(40875),r(10287),r(38781),r(52675),r(89463),r(28706),r(2008),r(50113),r(74423),r(23792),r(62062),r(34782),r(26910),r(62010),r(26099),r(3362),r(27495),r(21699),r(47764),r(5746),r(42762),r(23500),r(62953),r(48408),r(90407),r(87006),r(90062),r(380),r(49078),r(14822),r(36099),r(16738),r(46225);var u=[],d=[],l=1,s={N:"bg-gray-500",R:"bg-blue-500",SR:"bg-purple-500",SSR:"bg-yellow-500",UR:"bg-red-500",LR:"bg-gradient-to-r from-purple-500 to-pink-500"},f={1:"N",2:"R",3:"SR",4:"SSR",5:"UR",6:"LR"};function v(n){var t=document.getElementById("all-cards");t&&(t.innerHTML="",n.forEach(function(n){var r=function(n){var t=document.createElement("div");t.className="card-container relative group cursor-pointer transform transition-all duration-300 hover:scale-105",t.dataset.cardId=n.id;var r=n.rarity||"N",e=s[r]||s.N,o=!0===n.isHolo||"true"===n.isHolo,a=o?"holo-card":"",i=o?'<div class="holo-overlay"></div>':"";t.innerHTML='\n        <div class="bg-white rounded-xl shadow-lg overflow-hidden '.concat(a,'">\n            \x3c!-- 卡牌图片容器 --\x3e\n            <div class="relative h-64 bg-gradient-to-br from-gray-800 to-gray-900 overflow-hidden rounded-xl card-image-container">\n                \x3c!-- 图片加载占位符 --\x3e\n                <div class="card-image-placeholder">\n                    <div class="text-center">\n                        <div class="card-loading-spinner mx-auto mb-2"></div>\n                        <div class="text-white">加载中...</div>\n                    </div>\n                </div>\n                \n                <img src="').concat(n.image,'" alt="').concat(n.name,'" \n                     class="w-full h-full object-cover rounded-xl card-image"\n                     loading="lazy"\n                     data-card-name="').concat(n.name,'">\n                \n                \x3c!-- 闪卡光晕效果 --\x3e\n                ').concat(i,'\n                \n                \x3c!-- 稀有度标签 --\x3e\n                <div class="absolute top-2 right-2 ').concat(e,' text-white px-2 py-1 rounded-full text-xs font-bold rarity-badge">\n                    ').concat(r,"\n                </div>\n                \n                \x3c!-- 闪卡标识 --\x3e\n                ").concat(o?'<div class="absolute top-2 left-2 bg-yellow-400 text-black px-2 py-1 rounded-full text-xs font-bold">✨ HOLO</div>':"",'\n            </div>\n            \n            \x3c!-- 卡牌信息 --\x3e\n            <div class="p-4">\n                <div class="flex justify-between items-start mb-2">\n                    <h3 class="text-lg font-bold text-gray-900 truncate">').concat(n.name,'</h3>\n                    <span class="text-sm text-gray-500 ml-2 category-tag">').concat(n.category,'</span>\n                </div>\n                \n                <p class="text-sm text-gray-600 mb-3 line-clamp-2">').concat(n.description,'</p>\n                \n                <div class="text-xl font-bold text-indigo-600 card-price">¥').concat(n.price.toLocaleString(),"</div>\n            </div>\n        </div>\n    ");var c=t.querySelector(".card-image"),u=t.querySelector(".card-image-placeholder");return c&&u&&(c.onload=function(){this.classList.add("loaded"),u.classList.add("hidden")},c.onerror=function(){this.classList.add("error"),this.src=function(n,t){var r={N:{primary:"#6b7280",secondary:"#4b5563"},R:{primary:"#3b82f6",secondary:"#1e40af"},SR:{primary:"#8b5cf6",secondary:"#6d28d9"},SSR:{primary:"#f59e0b",secondary:"#d97706"},UR:{primary:"#ef4444",secondary:"#dc2626"},LR:{primary:"#ec4899",secondary:"#db2777"}},e=r[t]||r.N,o=document.createElement("canvas"),a=o.getContext("2d");o.width=300,o.height=420;var i=24;a.beginPath(),a.moveTo(i,0),a.lineTo(o.width-i,0),a.arcTo(o.width,0,o.width,i,i),a.lineTo(o.width,o.height-i),a.arcTo(o.width,o.height,o.width-i,o.height,i),a.lineTo(i,o.height),a.arcTo(0,o.height,0,o.height-i,i),a.lineTo(0,i),a.arcTo(0,0,i,0,i),a.closePath(),a.clip();var c=a.createLinearGradient(0,0,o.width,o.height);c.addColorStop(0,e.primary),c.addColorStop(1,e.secondary),a.fillStyle=c,a.fillRect(0,0,o.width,o.height),a.fillStyle="white",a.font="bold 20px Arial, sans-serif",a.textAlign="center",a.textBaseline="middle",a.shadowColor="rgba(0, 0, 0, 0.5)",a.shadowBlur=2,a.shadowOffsetX=1,a.shadowOffsetY=1;for(var u=o.width-40,d=n.split(""),l="",s=[],f=0;f<d.length;f++){var v=l+d[f];a.measureText(v).width>u&&f>0?(s.push(l),l=d[f]):l=v}s.push(l);var g=o.height/2-25*(s.length-1)/2;return s.forEach(function(n,t){a.fillText(n,o.width/2,g+25*t)}),a.font="bold 16px Arial, sans-serif",a.fillStyle="rgba(255, 255, 255, 0.9)",a.fillText(t,o.width/2,o.height-30),o.toDataURL("image/png")}(n.name,r),u.classList.add("hidden")},c.complete&&(c.naturalWidth>0?c.onload():c.onerror())),t}(n);t.appendChild(r)}),w(),function(){var n=document.getElementById("pagination");if(n){var t=m();if(t<=1)n.innerHTML="";else{var r="",e=l>1;r+='\n        <button class="pagination-btn px-3 py-2 rounded-lg border transition-colors '.concat(e?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed",'" \n                ').concat(e?'onclick="loadPage('.concat(l-1,')"'):"disabled",'>\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>\n            </svg>\n        </button>\n    '),r+='\n        <span class="px-4 py-2 text-gray-700 font-medium">\n            '.concat(l,"\n        </span>\n    ");var o=l<t;r+='\n        <button class="pagination-btn px-3 py-2 rounded-lg border transition-colors '.concat(o?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed",'" \n                ').concat(o?'onclick="loadPage('.concat(l+1,')"'):"disabled",'>\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>\n            </svg>\n        </button>\n    '),n.innerHTML=r}}}())}function g(){return b.apply(this,arguments)}function b(){var n;return n=e().m(function n(){var t,r,o;return e().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,y(),t=!1,window.CardAPI){n.n=1;break}t=!1,n.n=4;break;case 1:return n.p=1,n.n=2,window.CardAPI.getCardPage({page:1,size:20,sort:"id,DESC",pageDTO:{status:1}});case 2:(r=n.v)&&200===r.code&&r.data?(o=[],r.data.records&&Array.isArray(r.data.records)?o=r.data.records:r.data.content&&Array.isArray(r.data.content)?o=r.data.content:Array.isArray(r.data)&&(o=r.data),o.length>0?(u=o.map(function(n){var t,r=(t=n.rarity,f[t]||"N"),e=!0===n.isHolo||"true"===n.isHolo||1===n.isHolo;return{id:n.id,name:n.cardName||n.name||"未知卡牌",image:n.imageUrl||"/icon.png",category:n.series||n.category||"未分类",description:n.lore||n.description||"暂无描述",price:n.marketPrice||0,rarity:r,element:n.element||"",attackPower:n.attackPower||0,defensePower:n.defensePower||0,hp:n.hp||0,skillName:n.skillName||"",skillEffect:n.skillEffect||"",cardNumber:n.cardNumber||"",isHolo:e,o:n}}),t=!0,u.length>0&&u.slice(0,3).forEach(function(n,t){})):t=!1):t=!1,n.n=4;break;case 3:n.p=3,n.v,t=!1;case 4:if(t){n.n=5;break}return x(),n.a(2);case 5:return d=a(u),n.n=6,new Promise(function(n){return setTimeout(n,300)});case 6:l=1,p(1),h(),w(),k(),T(),n.n=8;break;case 7:n.p=7,n.v,x();case 8:return n.a(2)}},n,null,[[1,3],[0,7]])}),b=function(){var t=this,r=arguments;return new Promise(function(e,o){var a=n.apply(t,r);function i(n){c(a,e,o,i,u,"next",n)}function u(n){c(a,e,o,i,u,"throw",n)}i(void 0)})},b.apply(this,arguments)}function p(n){var t=10*(n-1),r=t+10,e=d.slice(t,r);l=n,v(e),window.scrollTo({top:0,behavior:"smooth"})}function m(){return Math.ceil(d.length/10)}function y(){var n=document.getElementById("all-cards");n&&(n.innerHTML='\n            <div class="col-span-full flex justify-center items-center py-12">\n                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"></div>\n                <span class="ml-3 text-gray-600">加载中...</span>\n            </div>\n        ')}function h(){}function x(){var n=document.getElementById("all-cards");n&&(n.innerHTML='\n            <div class="col-span-full text-center py-12">\n                <div class="text-gray-400 mb-4">\n                    <svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>\n                    </svg>\n                </div>\n                <p class="text-gray-600 mb-4">❌ 无法从服务器加载卡牌数据</p>\n                <p class="text-gray-500 mb-4 text-sm">请检查服务器是否正常运行，或查看浏览器控制台获取详细错误信息</p>\n                <button onclick="loadHomeData()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition-colors">\n                    🔄 重新加载\n                </button>\n            </div>\n        ')}function w(){document.querySelectorAll(".card-container").forEach(function(n){n.addEventListener("click",function(t){t.target.closest("button")||R(n.dataset.cardId)})})}function k(){var n,t=document.getElementById("search-input");t&&t.addEventListener("input",function(t){clearTimeout(n),n=setTimeout(function(){t.target.value.trim(),j()},300)});var r=document.getElementById("category-filter");r&&r.addEventListener("change",function(n){n.target.value,j()});var e=document.getElementById("rarity-filter");e&&e.addEventListener("change",function(n){n.target.value,j()});var o=document.getElementById("price-filter");o&&o.addEventListener("change",function(n){n.target.value,j()});var a=document.getElementById("sort-filter");a&&a.addEventListener("change",function(n){S(n.target.value)})}function S(n){switch(n){case"price-low":d.sort(function(n,t){return n.price-t.price});break;case"price-high":d.sort(function(n,t){return t.price-n.price});break;case"popular":var t={LR:6,UR:5,SSR:4,SR:3,R:2,N:1};d.sort(function(n,r){var e=1e3*t[n.rarity]+n.price;return 1e3*t[r.rarity]+r.price-e});break;default:d.sort(function(n,t){return t.id-n.id})}l=1,p(1)}function R(n){u.find(function(t){return t.id==n})&&(window.location.href="/card-detail.html?id=".concat(n))}function j(){var n,t,r,e,o=a(u),i=(null===(n=document.getElementById("search-input"))||void 0===n?void 0:n.value.trim())||"",c=(null===(t=document.getElementById("category-filter"))||void 0===t?void 0:t.value)||"all",s=(null===(r=document.getElementById("rarity-filter"))||void 0===r?void 0:r.value)||"",f=(null===(e=document.getElementById("price-filter"))||void 0===e?void 0:e.value)||"";if(i&&(o=o.filter(function(n){return n.name.toLowerCase().includes(i.toLowerCase())||n.description.toLowerCase().includes(i.toLowerCase())||n.skillName.toLowerCase().includes(i.toLowerCase())})),"all"!==c&&(o=o.filter(function(n){return n.category===c})),s&&(o=o.filter(function(n){return n.rarity===s})),f){var v=0,g=1/0;switch(f){case"0-1000":v=0,g=1e3;break;case"1000-5000":v=1e3,g=5e3;break;case"5000-10000":v=5e3,g=1e4;break;case"10000+":v=1e4,g=1/0}o=o.filter(function(n){return n.price>=v&&n.price<=g})}d=o,l=1,p(1)}function T(){var n=new URLSearchParams(window.location.search).get("category");if(n){var t=document.getElementById("category-filter");t&&(t.value=n),j();var r=window.location.pathname;window.history.replaceState({},document.title,r)}}document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var n;window.CardAPI?g():x(),n=new IntersectionObserver(function(n){n.forEach(function(n){n.isIntersecting&&n.target.classList.add("visible")})},{threshold:.1,rootMargin:"0px 0px -50px 0px"}),document.querySelectorAll("section").forEach(function(t){t.classList.add("fade-in-up"),n.observe(t)})},200)}),window.HomeModule={loadHomeData:g,showCardDetail:R,renderCards:v,filterCards:function(n){var t=document.getElementById("category-filter");t&&(t.value="all"===n?"all":n),j()},sortCards:S,loadPage:p,getTotalPages:m,getCardById:function(n){return u.find(function(t){return t.id==n})},getCardsByCategory:function(n,t){return u.filter(function(r){return r.category===n&&r.id!=t}).slice(0,4)}},window.loadPage=p,window.buyCard=function(n,t){!function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=document.createElement("div");r.className="fixed top-4 right-4 z-50 px-6 py-3 rounded-lg text-white font-medium transform transition-all duration-300 translate-x-full ".concat("success"===t?"bg-green-500":"error"===t?"bg-red-500":"bg-blue-500"),r.textContent=n,document.body.appendChild(r),setTimeout(function(){r.classList.remove("translate-x-full")},100),setTimeout(function(){r.classList.add("translate-x-full"),setTimeout(function(){document.body.removeChild(r)},300)},3e3)}("正在购买 ".concat(t,"..."),"info")}},46225:(n,t,r)=>{r.r(t)}},n=>{n.O(0,[502,955],()=>n(n.s=24703)),n.O()}]);