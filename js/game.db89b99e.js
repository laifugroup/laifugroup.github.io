"use strict";(self.webpackChunkshanhaijing_card_game=self.webpackChunkshanhaijing_card_game||[]).push([[485],{17741:(e,t,n)=>{function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach(function(t){_defineProperty(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function _defineProperty(e,t,n){return(t=function _toPropertyKey(e){var t=function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=_typeof(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_typeof(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}n(52675),n(89463),n(2259),n(45700),n(23418),n(34782),n(89572),n(2892),n(83851),n(81278),n(79432),n(27495),n(38781),n(28706),n(2008),n(50113),n(23792),n(62062),n(54554),n(62010),n(26099),n(31415),n(47764),n(23500),n(62953),n(90407),n(87006),n(90062),n(380),n(49078),n(14822),n(36099),n(16738),n(42131);var a={mode:null,inGame:!1,playerHP:30,opponentHP:30,playerMana:3,maxMana:5,currentTurn:"player",turnTimer:30,handCards:[],playerField:[],opponentField:[],deck:[],collection:[]},r=[],o=[{id:1,name:"青龙",cost:3,attack:4,health:3,rarity:"SSR",type:"神兽",description:"东方青龙，掌控风雷之力",icon:"🐉"},{id:2,name:"白虎",cost:2,attack:3,health:2,rarity:"SR",type:"神兽",description:"西方白虎，威震四方",icon:"🐅"},{id:3,name:"朱雀",cost:4,attack:5,health:2,rarity:"SSR",type:"神兽",description:"南方朱雀，烈火焚天",icon:"🔥"},{id:4,name:"玄武",cost:5,attack:2,health:8,rarity:"UR",type:"神兽",description:"北方玄武，坚不可摧",icon:"🛡️"},{id:5,name:"九尾狐",cost:3,attack:3,health:4,rarity:"SR",type:"妖兽",description:"九尾天狐，魅惑众生",icon:"🦊"},{id:6,name:"饕餮",cost:4,attack:6,health:3,rarity:"SR",type:"妖兽",description:"上古凶兽，吞噬万物",icon:"👹"},{id:7,name:"凤凰",cost:6,attack:4,health:6,rarity:"UR",type:"神兽",description:"不死神鸟，浴火重生",icon:"🔥"},{id:8,name:"麒麟",cost:5,attack:4,health:5,rarity:"UR",type:"神兽",description:"仁德瑞兽，祥瑞之兆",icon:"🦄"}];function drawCard(){if(0===a.deck.length)return addBattleLog("牌库已空！"),null;if(a.handCards.length>=10)return addBattleLog("手牌已满，无法抽卡！"),null;var e=a.deck.pop();return a.handCards.push(_objectSpread(_objectSpread({},e),{},{instanceId:Date.now()+Math.random()})),addBattleLog("抽到了 ".concat(e.name)),e}function updateGameInterface(){updateHP(),function updateMana(){var e=document.querySelectorAll(".mana-crystal"),t=document.querySelector(".mana-text");e.forEach(function(e,t){t<a.playerMana?e.classList.add("active"):e.classList.remove("active")}),t&&(t.textContent="".concat(a.playerMana,"/").concat(a.maxMana))}(),function updateHandCards(){var e=document.getElementById("hand-cards");if(!e)return;e.innerHTML="",a.handCards.forEach(function(t,n){var r=function createGameCardElement(e,t){var n=document.createElement("div");n.className="game-card",n.dataset.cardIndex=t;var r=e.cost<=a.playerMana&&"player"===a.currentTurn;r||(n.style.opacity="0.5");return n.innerHTML='\n        <div class="card-cost">'.concat(e.cost,'</div>\n        <div class="card-image">').concat(e.icon,'</div>\n        <div class="card-info">\n            <div class="card-name">').concat(e.name,'</div>\n            <div class="card-stats">\n                <div class="card-attack">').concat(e.attack,'</div>\n                <div class="card-health">').concat(e.health,"</div>\n            </div>\n        </div>\n    "),n.addEventListener("click",function(){r&&function playCard(e){var t=a.handCards[e];if(!t||t.cost>a.playerMana)return;if(a.playerField.length>=5)return void addBattleLog("场上已满，无法召唤更多生物！");a.playerMana-=t.cost,a.handCards.splice(e,1),a.playerField.push(_objectSpread(_objectSpread({},t),{},{canAttack:!1})),addBattleLog("你召唤了 ".concat(t.name)),updateGameInterface(),updatePlayerField(),function playCardAnimation(e){var t=document.querySelectorAll(".game-card");t[e]&&t[e].classList.add("playing")}(e)}(t)}),n}(t,n);e.appendChild(r)})}(),updateTurnIndicator()}function updateHP(){var e=document.querySelector(".player-area .hp-fill"),t=document.querySelector(".player-area .hp-text");if(e&&t){var n=a.playerHP/30*100;e.style.width="".concat(n,"%"),t.textContent="".concat(a.playerHP,"/30")}var r=document.querySelector(".opponent-area .hp-fill"),o=document.querySelector(".opponent-area .hp-text");if(r&&o){var c=a.opponentHP/30*100;r.style.width="".concat(c,"%"),o.textContent="".concat(a.opponentHP,"/30")}}function updatePlayerField(){document.querySelectorAll(".player-area .card-slot").forEach(function(e,t){if(a.playerField[t]){var n=a.playerField[t];e.classList.add("occupied"),e.innerHTML='\n                <div class="field-card">\n                    <div class="field-card-icon">'.concat(n.icon,'</div>\n                    <div class="field-card-stats">\n                        <span class="field-attack">').concat(n.attack,'</span>\n                        <span class="field-health">').concat(n.health,"</span>\n                    </div>\n                </div>\n            ")}else e.classList.remove("occupied"),e.innerHTML=""})}function updateTurnIndicator(){var e=document.querySelector(".current-turn"),t=document.querySelector(".timer-text");e&&(e.textContent="player"===a.currentTurn?"你的回合":"对手回合"),t&&(t.textContent=a.turnTimer)}function endTurn(){"player"===a.currentTurn?(a.currentTurn="opponent",addBattleLog("你的回合结束"),setTimeout(function(){!function opponentTurn(){addBattleLog("对手正在思考..."),setTimeout(function(){var e=Math.floor(5*Math.random())+1;a.playerHP-=e,addBattleLog("对手对你造成了 ".concat(e," 点伤害")),function showDamageEffect(e,t){var n="player"===t?document.querySelector(".player-area"):document.querySelector(".opponent-area");if(!n)return;var a=document.createElement("div");a.className="damage-effect",a.textContent="-".concat(e),a.style.position="absolute",a.style.left="50%",a.style.top="50%",a.style.transform="translate(-50%, -50%)",n.style.position="relative",n.appendChild(a),setTimeout(function(){a.parentNode&&a.parentNode.removeChild(a)},1e3)}(e,"player"),updateHP(),a.playerHP<=0?function endGame(e){r.forEach(function(e){return clearInterval(e)}),r=[];var t="victory"===e?"恭喜你获得了胜利！":"很遗憾，你失败了！";setTimeout(function(){alert(t),exitGame()},1e3)}("defeat"):setTimeout(function(){endTurn()},1e3)},2e3)}()},1e3)):(a.currentTurn="player",addBattleLog("对手回合结束"),function playerTurnStart(){a.maxMana<10&&a.maxMana++;a.playerMana=a.maxMana,drawCard(),a.playerField.forEach(function(e){e.canAttack=!0}),addBattleLog("你的回合开始"),updateGameInterface(),updatePlayerField()}()),a.turnTimer=30,updateTurnIndicator()}function addBattleLog(e){var t=document.querySelector(".battle-log");if(t){var n=document.createElement("div");n.className="log-entry",n.textContent=e,t.appendChild(n),t.scrollTop=t.scrollHeight;var a=t.querySelectorAll(".log-entry");a.length>20&&a[0].remove()}}function showDeck(){var e=document.getElementById("deck-modal");e&&(e.classList.remove("hidden"),document.body.style.overflow="hidden",renderCurrentDeck(),function renderCollection(){var e=document.getElementById("collection-cards");if(!e)return;e.innerHTML="",a.collection.forEach(function(t){var n=function createCollectionCardElement(e){var t=document.createElement("div");return t.className="collection-card",t.innerHTML='\n        <div class="mini-card">\n            <div class="mini-card-cost">'.concat(e.cost,'</div>\n            <div class="mini-card-icon">').concat(e.icon,'</div>\n            <div class="mini-card-name">').concat(e.name,"</div>\n        </div>\n    "),t.addEventListener("click",function(){!function addToDeck(e){if(a.deck.length>=30)return void alert("卡组已满！");var t=a.deck.filter(function(t){return t.id===e.id}).length;if(t>=2)return void alert("同名卡牌最多只能添加2张！");a.deck.push(e),renderCurrentDeck()}(e)}),t}(t);e.appendChild(n)})}())}function renderCurrentDeck(){var e=document.getElementById("current-deck");if(e){e.innerHTML="";var t={};a.deck.forEach(function(e){t[e.id]=(t[e.id]||0)+1}),_toConsumableArray(new Set(a.deck.map(function(e){return e.id}))).map(function(e){return a.deck.find(function(t){return t.id===e})}).forEach(function(n){var a=function createDeckCardElement(e,t){var n=document.createElement("div");return n.className="deck-card",n.innerHTML='\n        <div class="mini-card">\n            <div class="mini-card-cost">'.concat(e.cost,'</div>\n            <div class="mini-card-icon">').concat(e.icon,'</div>\n            <div class="mini-card-name">').concat(e.name,'</div>\n            <div class="mini-card-count">x').concat(t,"</div>\n        </div>\n    "),n}(n,t[n.id]);e.appendChild(a)})}}function closeDeckModalFunc(){var e=document.getElementById("deck-modal");e&&(e.classList.add("hidden"),document.body.style.overflow="")}function exitGame(){r.forEach(function(e){return clearInterval(e)}),r=[],a.inGame=!1,a.mode=null,document.querySelector("section").style.display="block",document.getElementById("game-interface").classList.add("hidden")}document.addEventListener("DOMContentLoaded",function(){console.log("🎮 游戏页面初始化开始"),function initializeGameData(){a.collection=[].concat(o),a.deck=[o[0],o[1],o[2],o[3],o[4],o[5],o[0],o[1],o[2],o[3],o[4],o[5],o[0],o[1],o[2],o[3],o[4],o[5],o[0],o[1],o[2],o[3],o[4],o[5],o[0],o[1],o[2],o[3],o[4],o[5]]}(),function bindEvents(){document.querySelectorAll(".game-mode-card").forEach(function(e){e.addEventListener("click",function(){!function selectGameMode(e){switch(a.mode=e,e){case"battle":!function startBattle(){console.log("开始对战模式"),document.querySelector("section").style.display="none",document.getElementById("game-interface").classList.remove("hidden"),a.inGame=!0,a.playerHP=30,a.opponentHP=30,a.playerMana=1,a.maxMana=1,a.currentTurn="player",a.turnTimer=30,function shuffleDeck(){for(var e=_toConsumableArray(a.deck),t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=[e[n],e[t]];e[t]=r[0],e[n]=r[1]}a.deck=e}(),function drawInitialHand(){a.handCards=[];for(var e=0;e<4;e++)drawCard()}(),updateGameInterface(),function startTurnTimer(){r.forEach(function(e){return clearInterval(e)}),r=[];var e=setInterval(function(){a.turnTimer--,updateTurnIndicator(),a.turnTimer<=0&&endTurn()},1e3);r.push(e)}(),addBattleLog("游戏开始！你先手。")}();break;case"adventure":!function startAdventure(){console.log("开始冒险模式"),alert("冒险模式正在开发中，敬请期待！")}();break;case"arena":!function startArena(){console.log("开始竞技场模式"),alert("竞技场模式正在开发中，敬请期待！")}();break;default:console.log("未知游戏模式:",e)}}(this.dataset.mode)})});var e=document.getElementById("deck-modal"),t=document.getElementById("close-deck-modal");t&&t.addEventListener("click",closeDeckModalFunc);e&&e.addEventListener("click",function(t){t.target===e&&closeDeckModalFunc()})}(),console.log("✅ 游戏页面初始化完成")}),window.showDeck=showDeck,window.showCollection=function showCollection(){showDeck()},window.showShop=function showShop(){alert("商店功能正在开发中，敬请期待！")},window.exitGame=exitGame,window.addEventListener("beforeunload",function(){r.forEach(function(e){return clearInterval(e)})}),console.log("✅ 游戏页面脚本已加载")},42131:(e,t,n)=>{n.r(t)}},e=>{e.O(0,[502,955],()=>{return t=17741,e(e.s=t);var t});e.O()}]);