"use strict";(self.webpackChunkshanhaijing_card_game=self.webpackChunkshanhaijing_card_game||[]).push([[485],{17741:(n,t,e)=>{function a(n){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},a(n)}function i(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),e.push.apply(e,a)}return e}function c(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach(function(t){r(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function r(n,t,e){return(t=function(n){var t=function(n){if("object"!=a(n)||!n)return n;var t=n[Symbol.toPrimitive];if(void 0!==t){var e=t.call(n,"string");if("object"!=a(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}(n);return"symbol"==a(t)?t:t+""}(t))in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function o(n){return function(n){if(Array.isArray(n))return d(n)}(n)||function(n){if("undefined"!=typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,t){if(n){if("string"==typeof n)return d(n,t);var e={}.toString.call(n).slice(8,-1);return"Object"===e&&n.constructor&&(e=n.constructor.name),"Map"===e||"Set"===e?Array.from(n):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?d(n,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(n,t){(null==t||t>n.length)&&(t=n.length);for(var e=0,a=Array(t);e<t;e++)a[e]=n[e];return a}e(52675),e(89463),e(2259),e(45700),e(23418),e(34782),e(89572),e(2892),e(83851),e(81278),e(79432),e(27495),e(38781),e(28706),e(2008),e(50113),e(23792),e(62062),e(54554),e(62010),e(26099),e(31415),e(47764),e(23500),e(62953),e(90407),e(87006),e(90062),e(380),e(49078),e(14822),e(36099),e(16738),e(42131);var u={mode:null,inGame:!1,playerHP:30,opponentHP:30,playerMana:3,maxMana:5,currentTurn:"player",turnTimer:30,handCards:[],playerField:[],opponentField:[],deck:[],collection:[]},l=[],f=[{id:1,name:"青龙",cost:3,attack:4,health:3,rarity:"SSR",type:"神兽",description:"东方青龙，掌控风雷之力",icon:"🐉"},{id:2,name:"白虎",cost:2,attack:3,health:2,rarity:"SR",type:"神兽",description:"西方白虎，威震四方",icon:"🐅"},{id:3,name:"朱雀",cost:4,attack:5,health:2,rarity:"SSR",type:"神兽",description:"南方朱雀，烈火焚天",icon:"🔥"},{id:4,name:"玄武",cost:5,attack:2,health:8,rarity:"UR",type:"神兽",description:"北方玄武，坚不可摧",icon:"🛡️"},{id:5,name:"九尾狐",cost:3,attack:3,health:4,rarity:"SR",type:"妖兽",description:"九尾天狐，魅惑众生",icon:"🦊"},{id:6,name:"饕餮",cost:4,attack:6,health:3,rarity:"SR",type:"妖兽",description:"上古凶兽，吞噬万物",icon:"👹"},{id:7,name:"凤凰",cost:6,attack:4,health:6,rarity:"UR",type:"神兽",description:"不死神鸟，浴火重生",icon:"🔥"},{id:8,name:"麒麟",cost:5,attack:4,health:5,rarity:"UR",type:"神兽",description:"仁德瑞兽，祥瑞之兆",icon:"🦄"}];function s(){if(0===u.deck.length)return b("牌库已空！"),null;if(u.handCards.length>=10)return b("手牌已满，无法抽卡！"),null;var n=u.deck.pop();return u.handCards.push(c(c({},n),{},{instanceId:Date.now()+Math.random()})),b("抽到了 ".concat(n.name)),n}function v(){var n,t,e;m(),n=document.querySelectorAll(".mana-crystal"),t=document.querySelector(".mana-text"),n.forEach(function(n,t){t<u.playerMana?n.classList.add("active"):n.classList.remove("active")}),t&&(t.textContent="".concat(u.playerMana,"/").concat(u.maxMana)),(e=document.getElementById("hand-cards"))&&(e.innerHTML="",u.handCards.forEach(function(n,t){var a=function(n,t){var e=document.createElement("div");e.className="game-card",e.dataset.cardIndex=t;var a=n.cost<=u.playerMana&&"player"===u.currentTurn;return a||(e.style.opacity="0.5"),e.innerHTML='\n        <div class="card-cost">'.concat(n.cost,'</div>\n        <div class="card-image">').concat(n.icon,'</div>\n        <div class="card-info">\n            <div class="card-name">').concat(n.name,'</div>\n            <div class="card-stats">\n                <div class="card-attack">').concat(n.attack,'</div>\n                <div class="card-health">').concat(n.health,"</div>\n            </div>\n        </div>\n    "),e.addEventListener("click",function(){a&&function(n){var t=u.handCards[n];!t||t.cost>u.playerMana||(u.playerField.length>=5?b("场上已满，无法召唤更多生物！"):(u.playerMana-=t.cost,u.handCards.splice(n,1),u.playerField.push(c(c({},t),{},{canAttack:!1})),b("你召唤了 ".concat(t.name)),v(),p(),function(n){var t=document.querySelectorAll(".game-card");t[n]&&t[n].classList.add("playing")}(n)))}(t)}),e}(n,t);e.appendChild(a)})),y()}function m(){var n=document.querySelector(".player-area .hp-fill"),t=document.querySelector(".player-area .hp-text");if(n&&t){var e=u.playerHP/30*100;n.style.width="".concat(e,"%"),t.textContent="".concat(u.playerHP,"/30")}var a=document.querySelector(".opponent-area .hp-fill"),i=document.querySelector(".opponent-area .hp-text");if(a&&i){var c=u.opponentHP/30*100;a.style.width="".concat(c,"%"),i.textContent="".concat(u.opponentHP,"/30")}}function p(){document.querySelectorAll(".player-area .card-slot").forEach(function(n,t){if(u.playerField[t]){var e=u.playerField[t];n.classList.add("occupied"),n.innerHTML='\n                <div class="field-card">\n                    <div class="field-card-icon">'.concat(e.icon,'</div>\n                    <div class="field-card-stats">\n                        <span class="field-attack">').concat(e.attack,'</span>\n                        <span class="field-health">').concat(e.health,"</span>\n                    </div>\n                </div>\n            ")}else n.classList.remove("occupied"),n.innerHTML=""})}function y(){var n=document.querySelector(".current-turn"),t=document.querySelector(".timer-text");n&&(n.textContent="player"===u.currentTurn?"你的回合":"对手回合"),t&&(t.textContent=u.turnTimer)}function h(){"player"===u.currentTurn?(u.currentTurn="opponent",b("你的回合结束"),setTimeout(function(){b("对手正在思考..."),setTimeout(function(){var n=Math.floor(5*Math.random())+1;u.playerHP-=n,b("对手对你造成了 ".concat(n," 点伤害")),function(n){var t=document.querySelector(".player-area");if(t){var e=document.createElement("div");e.className="damage-effect",e.textContent="-".concat(n),e.style.position="absolute",e.style.left="50%",e.style.top="50%",e.style.transform="translate(-50%, -50%)",t.style.position="relative",t.appendChild(e),setTimeout(function(){e.parentNode&&e.parentNode.removeChild(e)},1e3)}}(n),m(),u.playerHP<=0?function(){l.forEach(function(n){return clearInterval(n)}),l=[];setTimeout(function(){alert("很遗憾，你失败了！"),g()},1e3)}():setTimeout(function(){h()},1e3)},2e3)},1e3)):(u.currentTurn="player",b("对手回合结束"),u.maxMana<10&&u.maxMana++,u.playerMana=u.maxMana,s(),u.playerField.forEach(function(n){n.canAttack=!0}),b("你的回合开始"),v(),p()),u.turnTimer=30,y()}function b(n){var t=document.querySelector(".battle-log");if(t){var e=document.createElement("div");e.className="log-entry",e.textContent=n,t.appendChild(e),t.scrollTop=t.scrollHeight;var a=t.querySelectorAll(".log-entry");a.length>20&&a[0].remove()}}function k(){var n,t=document.getElementById("deck-modal");t&&(t.classList.remove("hidden"),document.body.style.overflow="hidden",S(),(n=document.getElementById("collection-cards"))&&(n.innerHTML="",u.collection.forEach(function(t){var e=function(n){var t=document.createElement("div");return t.className="collection-card",t.innerHTML='\n        <div class="mini-card">\n            <div class="mini-card-cost">'.concat(n.cost,'</div>\n            <div class="mini-card-icon">').concat(n.icon,'</div>\n            <div class="mini-card-name">').concat(n.name,"</div>\n        </div>\n    "),t.addEventListener("click",function(){!function(n){u.deck.length>=30?alert("卡组已满！"):u.deck.filter(function(t){return t.id===n.id}).length>=2?alert("同名卡牌最多只能添加2张！"):(u.deck.push(n),S())}(n)}),t}(t);n.appendChild(e)})))}function S(){var n=document.getElementById("current-deck");if(n){n.innerHTML="";var t={};u.deck.forEach(function(n){t[n.id]=(t[n.id]||0)+1}),o(new Set(u.deck.map(function(n){return n.id}))).map(function(n){return u.deck.find(function(t){return t.id===n})}).forEach(function(e){var a=function(n,t){var e=document.createElement("div");return e.className="deck-card",e.innerHTML='\n        <div class="mini-card">\n            <div class="mini-card-cost">'.concat(n.cost,'</div>\n            <div class="mini-card-icon">').concat(n.icon,'</div>\n            <div class="mini-card-name">').concat(n.name,'</div>\n            <div class="mini-card-count">x').concat(t,"</div>\n        </div>\n    "),e}(e,t[e.id]);n.appendChild(a)})}}function w(){var n=document.getElementById("deck-modal");n&&(n.classList.add("hidden"),document.body.style.overflow="")}function g(){l.forEach(function(n){return clearInterval(n)}),l=[],u.inGame=!1,u.mode=null,document.querySelector("section").style.display="block",document.getElementById("game-interface").classList.add("hidden")}document.addEventListener("DOMContentLoaded",function(){u.collection=[].concat(f),u.deck=[f[0],f[1],f[2],f[3],f[4],f[5],f[0],f[1],f[2],f[3],f[4],f[5],f[0],f[1],f[2],f[3],f[4],f[5],f[0],f[1],f[2],f[3],f[4],f[5],f[0],f[1],f[2],f[3],f[4],f[5]],function(){document.querySelectorAll(".game-mode-card").forEach(function(n){n.addEventListener("click",function(){!function(n){switch(u.mode=n,n){case"battle":document.querySelector("section").style.display="none",document.getElementById("game-interface").classList.remove("hidden"),u.inGame=!0,u.playerHP=30,u.opponentHP=30,u.playerMana=1,u.maxMana=1,u.currentTurn="player",u.turnTimer=30,function(){for(var n=o(u.deck),t=n.length-1;t>0;t--){var e=Math.floor(Math.random()*(t+1)),a=[n[e],n[t]];n[t]=a[0],n[e]=a[1]}u.deck=n}(),function(){u.handCards=[];for(var n=0;n<4;n++)s()}(),v(),function(){l.forEach(function(n){return clearInterval(n)}),l=[];var n=setInterval(function(){u.turnTimer--,y(),u.turnTimer<=0&&h()},1e3);l.push(n)}(),b("游戏开始！你先手。");break;case"adventure":alert("冒险模式正在开发中，敬请期待！");break;case"arena":alert("竞技场模式正在开发中，敬请期待！")}}(this.dataset.mode)})});var n=document.getElementById("deck-modal"),t=document.getElementById("close-deck-modal");t&&t.addEventListener("click",w),n&&n.addEventListener("click",function(t){t.target===n&&w()})}()}),window.showDeck=k,window.showCollection=function(){k()},window.showShop=function(){alert("商店功能正在开发中，敬请期待！")},window.exitGame=g,window.addEventListener("beforeunload",function(){l.forEach(function(n){return clearInterval(n)})})},42131:(n,t,e)=>{e.r(t)}},n=>{n.O(0,[502,955],()=>n(n.s=17741)),n.O()}]);