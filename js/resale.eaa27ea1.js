"use strict";(self.webpackChunkshanhaijing_card_game=self.webpackChunkshanhaijing_card_game||[]).push([[313],{6087:(n,t,e)=>{e.r(t)},24925:(n,t,e)=>{function r(){var n,t,e="function"==typeof Symbol?Symbol:{},i=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,r,i,o){var c=r&&r.prototype instanceof l?r:l,d=Object.create(c.prototype);return a(d,"_invoke",function(e,r,a){var i,o,c,l=0,d=a||[],u=!1,f={p:0,n:0,v:n,a:v,f:v.bind(n,4),d:function(t,e){return i=t,o=0,c=n,f.n=e,s}};function v(e,r){for(o=e,c=r,t=0;!u&&l&&!a&&t<d.length;t++){var a,i=d[t],v=f.p,p=i[2];e>3?(a=p===r)&&(c=i[(o=i[4])?5:(o=3,3)],i[4]=i[5]=n):i[0]<=v&&((a=e<2&&v<i[1])?(o=0,f.v=r,f.n=i[1]):v<p&&(a=e<3||i[0]>r||r>p)&&(i[4]=e,i[5]=r,f.n=p,o=0))}if(a||e>1)return s;throw u=!0,r}return function(a,d,p){if(l>1)throw TypeError("Generator is already running");for(u&&1===d&&v(d,p),o=d,c=p;(t=o<2?n:c)||!u;){i||(o?o<3?(o>1&&(f.n=-1),v(o,c)):f.n=c:f.v=c);try{if(l=2,i){if(o||(a="next"),t=i[a]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,o<2&&(o=0)}else 1===o&&(t=i.return)&&t.call(i),o<2&&(c=TypeError("The iterator does not provide a '"+a+"' method"),o=1);i=n}else if((t=(u=f.n<0)?c:e.call(r,f))!==s)break}catch(t){i=n,o=1,c=t}finally{l=1}}return{value:t,done:u}}}(e,i,o),!0),d}var s={};function l(){}function d(){}function u(){}t=Object.getPrototypeOf;var f=[][i]?t(t([][i]())):(a(t={},i,function(){return this}),t),v=u.prototype=l.prototype=Object.create(f);function p(n){return Object.setPrototypeOf?Object.setPrototypeOf(n,u):(n.__proto__=u,a(n,o,"GeneratorFunction")),n.prototype=Object.create(v),n}return d.prototype=u,a(v,"constructor",u),a(u,"constructor",d),d.displayName="GeneratorFunction",a(u,o,"GeneratorFunction"),a(v),a(v,o,"Generator"),a(v,i,function(){return this}),a(v,"toString",function(){return"[object Generator]"}),(r=function(){return{w:c,m:p}})()}function a(n,t,e,r){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}a=function(n,t,e,r){function o(t,e){a(n,t,function(n){return this.t(t,e,n)})}t?i?i(n,t,{value:e,enumerable:!r,configurable:!r,writable:!r}):n[t]=e:(o("next",0),o("throw",1),o("return",2))},a(n,t,e,r)}function i(n,t,e,r,a,i,o){try{var c=n[i](o),s=c.value}catch(n){return void e(n)}c.done?t(s):Promise.resolve(s).then(r,a)}e(40875),e(10287),e(3362),e(52675),e(89463),e(28706),e(48598),e(62062),e(26910),e(62010),e(26099),e(27495),e(25440),e(5746),e(42762),e(23500),e(90407),e(87006),e(90062),e(380),e(49078),e(14822),e(36099),e(16738),e(6087);var o=1,c={search:"",category:"",rarity:"",priceRange:"",sort:"newest"},s=!1,l={1:"N",2:"R",3:"SR",4:"SSR",5:"UR",6:"LR"};function d(){return u.apply(this,arguments)}function u(){var n;return n=r().m(function n(){var t,e,a;return r().w(function(n){for(;;)switch(n.p=n.n){case 0:if(!s){n.n=1;break}return n.a(2);case 1:return s=!0,p(),n.p=2,n.n=3,window.ResaleAPI.getResalePage({page:o,size:8,sort:c.sort,filters:{search:c.search,category:c.category,rarity:c.rarity,priceRange:c.priceRange}});case 3:(t=n.v)&&200===t.code&&t.data?(e=[],t.data.records&&Array.isArray(t.data.records)&&(e=t.data.records),e.length>0?(f(e.map(function(n){var t,e=(t=n.rarity,l[t]||"N");return{id:n.id,name:n.cardName||n.name||"未知卡牌",image:n.imageUrl||"/icon.png",category:n.series||n.category||"未分类",description:n.lore||n.description||"暂无描述",price:n.price||0,originalPrice:n.originalPrice||n.price||0,rarity:e,element:n.element||"",status:n.status||"available",publishTime:n.publishTime||(new Date).toISOString(),views:n.views||0,favorites:n.favorites||0,tags:n.tags||[],seller:n.seller||{id:1,name:"匿名卖家",avatar:"/icon.png",rating:4.5,verified:!1,online:!1}}})),a=e.length>=8,v(t.data.total||e.length,8,a),m()):(f([]),v(0,8,!1),b())):h(),n.n=5;break;case 4:n.p=4,n.v,h();case 5:return n.p=5,s=!1,g(),n.f(5);case 6:return n.a(2)}},n,null,[[2,4,5,6]])}),u=function(){var t=this,e=arguments;return new Promise(function(r,a){var o=n.apply(t,e);function c(n){i(o,r,a,c,s,"next",n)}function s(n){i(o,r,a,c,s,"throw",n)}c(void 0)})},u.apply(this,arguments)}function f(n){var t=document.getElementById("marketplace-grid");if(t)if(0!==n.length){var e=n.map(function(n){return function(n){var t=n.originalPrice>n.price?Math.round(100*(1-n.price/n.originalPrice)):0;return'\n        <div class="marketplace-card" data-card-id="'.concat(n.id,'">\n            <div class="relative">\n                <img src="').concat(n.image,'" alt="').concat(n.name,'" class="card-image">\n                \x3c!-- 收藏按钮已移除 --\x3e\n                <div class="card-status ').concat({available:"available",sold:"sold",reserved:"reserved"}[n.status],'">').concat({available:"在售",sold:"已售",reserved:"预定"}[n.status],"</div>\n                ").concat(t>0?'<div class="absolute top-12 right-12 bg-red-500 text-white text-xs px-2 py-1 rounded">'.concat(t,"% OFF</div>"):"",'\n            </div>\n            \n            <div class="card-content">\n                <h3 class="card-title">').concat(n.name,'</h3>\n                \n                <div class="flex items-baseline mb-2">\n                    <span class="card-category">').concat(n.category,'</span>\n                    <span class="card-rarity ').concat(n.rarity,'">').concat(n.rarity,'</span>\n                </div>\n                \n                <div class="seller-info">\n                    <div class="card-seller">\n                        <img src="').concat(n.seller.avatar,'" alt="').concat(n.seller.name,'" class="seller-avatar">\n                        <span class="seller-name">').concat(n.seller.name,"</span>\n                        ").concat(n.seller.verified?'<span class="seller-verified">✓</span>':"",'\n                        <div class="seller-rating">\n                            <span class="rating-stars">★</span>\n                            <span class="rating-score">').concat(n.seller.rating,'</span>\n                        </div>\n                    </div>\n                    <div class="flex items-center text-xs text-gray-500">\n                        <span class="status-indicator ').concat(n.seller.online?"online":"offline",'"></span>\n                        ').concat(n.seller.online?"在线":"离线",'\n                        <span class="ml-4">').concat(n.views,' 浏览</span>\n                        <span class="ml-2">').concat(n.favorites,' 收藏</span>\n                    </div>\n                </div>\n                \n                <div class="card-price">\n                    ¥').concat(n.price.toLocaleString(),"\n                    ").concat(n.originalPrice>n.price?'<span class="text-sm text-gray-400 line-through ml-2">¥'.concat(n.originalPrice.toLocaleString(),"</span>"):"",'\n                </div>\n                \n                <p class="text-sm text-gray-600 mb-3 line-clamp-2">').concat(n.description,"</p>\n                \n                ").concat(n.tags.length>0?'\n                    <div class="tag-cloud mb-4">\n                        '.concat(n.tags.map(function(n){return'<span class="tag">'.concat(n,"</span>")}).join(""),"\n                    </div>\n                "):"",'\n                \n                <div class="card-actions mt-4">\n                    ').concat("available"===n.status?'\n                        <button class="btn-primary" onclick="buyCard('.concat(n.id,')">立即购买</button>\n                        <button class="btn-secondary" onclick="contactSeller(').concat(n.id,')">联系卖家</button>\n                    '):"reserved"===n.status?'\n                        <button class="btn-secondary" disabled>已预定</button>\n                        <button class="btn-secondary" onclick="contactSeller('.concat(n.id,')">联系卖家</button>\n                    '):'\n                        <button class="btn-secondary" disabled>已售出</button>\n                        <button class="btn-secondary" onclick="viewSimilar('.concat(n.id,')">查看相似</button>\n                    '),"\n                </div>\n            </div>\n        </div>\n    ")}(n)}).join("");t.innerHTML=e,document.querySelectorAll(".marketplace-card").forEach(function(n){n.addEventListener("click",function(){var n;n=this.dataset.cardId,window.location.href="/card-detail.html?id=".concat(n)})})}else t.innerHTML=""}function v(n,t){var e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=document.getElementById("pagination");if(r)if(1!==o||e){var a="",i=o>1;a+='\n        <button class="pagination-btn px-3 py-2 rounded-lg border transition-colors '.concat(i?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed",'" \n                ').concat(i?'onclick="changePage('.concat(o-1,')"'):"disabled",'>\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>\n            </svg>\n        </button>\n    '),a+='\n        <span class="px-4 py-2 text-gray-700 font-medium">\n            第 '.concat(o," 页\n        </span>\n    ");var c=e;a+='\n        <button class="pagination-btn px-3 py-2 rounded-lg border transition-colors '.concat(c?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed",'" \n                ').concat(c?'onclick="changePage('.concat(o+1,')"'):"disabled",'>\n            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>\n            </svg>\n        </button>\n    '),r.innerHTML=a}else r.innerHTML=""}function p(){var n=document.getElementById("loading-state"),t=document.getElementById("marketplace-grid");n&&n.classList.remove("hidden"),t&&t.classList.add("hidden")}function g(){var n=document.getElementById("loading-state"),t=document.getElementById("marketplace-grid");n&&n.classList.add("hidden"),t&&t.classList.remove("hidden")}function b(){var n=document.getElementById("empty-state");n&&n.classList.remove("hidden")}function m(){var n=document.getElementById("empty-state");n&&n.classList.add("hidden")}function h(n){}document.addEventListener("DOMContentLoaded",function(){var n,t;window.ResaleAPI&&((t=document.getElementById("search-input"))&&t.addEventListener("input",function(){var t=this;clearTimeout(n),n=setTimeout(function(){c.search=t.value.trim(),o=1,d()},500)}),["category-filter","rarity-filter","price-filter","sort-filter"].forEach(function(n){var t=document.getElementById(n);t&&t.addEventListener("change",function(){var t=n.replace("-filter","");"price"===t?c.priceRange=this.value:c[t]=this.value,o=1,d()})}),d())}),window.changePage=function(n){o=n,d(),window.scrollTo({top:0,behavior:"smooth"})},window.clearFilters=function(){c={search:"",category:"",rarity:"",priceRange:"",sort:"newest"},document.getElementById("search-input").value="",document.getElementById("category-filter").value="",document.getElementById("rarity-filter").value="",document.getElementById("price-filter").value="",document.getElementById("sort-filter").value="newest",o=1,d()},window.buyCard=function(n){confirm("确定要购买这张卡牌吗？")&&alert("跳转到支付页面...")},window.contactSeller=function(n){alert("正在联系卖家...")},window.viewSimilar=function(n){o=1,d()}}},n=>{n.O(0,[502,955],()=>n(n.s=24925)),n.O()}]);